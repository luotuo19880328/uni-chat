<view class="data-v-22c4c621"><view data-event-opts="{{[['touchstart',[['e0',['$event']]]]]}}" class="cu-chat data-v-22c4c621" bindtouchstart="__e"><scroll-view scroll-y="true" scroll-with-animation="{{scrollAnimation}}" scroll-top="{{scrollTop}}" scroll-into-view="{{scrollToView}}" upper-threshold="50" data-event-opts="{{[['scrolltoupper',[['loadHistory',['$event']]]]]}}" bindscrolltoupper="__e" class="data-v-22c4c621"><view class="loading data-v-22c4c621"><view class="spinner data-v-22c4c621"><view class="rect1 data-v-22c4c621"></view><view class="rect2 data-v-22c4c621"></view><view class="rect3 data-v-22c4c621"></view><view class="rect4 data-v-22c4c621"></view><view class="rect5 data-v-22c4c621"></view></view></view><block wx:for="{{msgList}}" wx:for-item="row" wx:for-index="index" wx:key="index"><view class="row data-v-22c4c621" id="{{'msg'+row.msg.id}}"><block wx:if="{{row.type=='system'}}"><block class="data-v-22c4c621"><block wx:if="{{row.msg.type=='text'}}"><view class="cu-info data-v-22c4c621">{{row.msg.content.text+"!"}}</view></block><block wx:if="{{row.msg.type=='redEnvelope'}}"><view class="cu-info data-v-22c4c621"><text class="cuIcon-redpacket_fill text-red data-v-22c4c621"></text>{{''+row.msg.content.text+''}}</view></block></block></block><block wx:if="{{row.type=='user'}}"><block class="data-v-22c4c621"><view class="{{['cu-item data-v-22c4c621',(row.msg.userinfo.uid==myuid)?'self':'']}}"><view class="cu-avatar radius data-v-22c4c621" style="background-image:url(https://ossweb-img.qq.com/images/lol/web201310/skin/big107000.jpg);"></view><view class="main data-v-22c4c621"><block wx:if="{{row.msg.type=='text'}}"><view class="content shadow data-v-22c4c621"><rich-text nodes="{{row.msg.content.text}}" class="data-v-22c4c621"></rich-text></view></block><block wx:if="{{row.msg.type=='img'}}"><image class="radius data-v-22c4c621" src="https://ossweb-img.qq.com/images/lol/web201310/skin/big10006.jpg" mode="widthFix"></image></block><block wx:if="{{row.msg.type=='voice'}}"><view class="content shadow data-v-22c4c621"><text class="cuIcon-sound text-xxl padding-right-xl data-v-22c4c621"></text></view><view class="action text-bold text-grey data-v-22c4c621">{{''+row.msg.content.length+' "'}}</view></block><block wx:if="{{row.msg.type=='redEnvelope'}}"><view data-event-opts="{{[['tap',[['openRedEnvelope',['$0',index],[[['msgList','',index,'msg']]]]]]]}}" class="red-envelope data-v-22c4c621" bindtap="__e"><image src="/static/img/red-envelope.png" class="data-v-22c4c621"></image><view class="blessing data-v-22c4c621">{{''+row.msg.content.blessing+''}}</view></view></block></view><view class="date data-v-22c4c621">{{row.msg.time}}</view></view></block></block></view></block></scroll-view></view><view class="{{['chat-bar data-v-22c4c621',(drawerVisible)?'open':'']}}"><view class="input-box data-v-22c4c621"><view data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" class="action data-v-22c4c621" bindtap="__e"><text class="cuIcon-roundadd text-grey data-v-22c4c621"></text></view><input class="solid-bottom data-v-22c4c621" adjust-position="{{false}}" focus="{{false}}" maxlength="300" cursor-spacing="10" data-event-opts="{{[['focus',[['InputFocus',['$event']]]],['blur',[['InputBlur',['$event']]]]]}}" bindfocus="__e" bindblur="__e"/><view class="action data-v-22c4c621"><text class="cuIcon-emojifill text-grey data-v-22c4c621"></text></view><button class="cu-btn bg-green shadow data-v-22c4c621">发送</button></view><view class="popup-layer padding-sm bg-gray data-v-22c4c621"><swiper class="swiper data-v-22c4c621"><swiper-item class="data-v-22c4c621"><view class="swiper-item data-v-22c4c621"><view class="menu-list grid col-4 data-v-22c4c621"><view class="padding-bottom-sm data-v-22c4c621"><view class="menu-item text-center bg-white radius data-v-22c4c621"><text class="cuIcon-redpacket_fill data-v-22c4c621"></text></view></view></view></view></swiper-item></swiper></view></view><view class="{{['modal data-v-22c4c621',(showModal)?'show':'']}}"><view data-event-opts="{{[['touchmove',[['discard',['$event']]]],['tap',[['closeRedEnvelope',['$event']]]]]}}" class="mask data-v-22c4c621" catchtouchmove="__e" bindtap="__e"></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="layer data-v-22c4c621" catchtouchmove="__e"><view class="open-redenvelope data-v-22c4c621"><view class="top data-v-22c4c621"><view class="close-btn text-xxl data-v-22c4c621"><text data-event-opts="{{[['tap',[['closeRedEnvelope',['$event']]]]]}}" class="cuIcon-close data-v-22c4c621" bindtap="__e"></text></view><image src="/static/img/avatar/face_1.jpg" class="data-v-22c4c621"></image></view><view class="from data-v-22c4c621">{{"来自"+redenvelopeData.from}}</view><view class="blessing data-v-22c4c621">{{redenvelopeData.blessing}}</view><view class="money data-v-22c4c621">{{redenvelopeData.money}}</view><view data-event-opts="{{[['tap',[['toDetails',['$0'],['redenvelopeData.rid']]]]]}}" class="showDetails data-v-22c4c621" bindtap="__e"><text class="data-v-22c4c621">查看领取详情</text><text class="cuIcon-right data-v-22c4c621"></text></view></view></view></view></view>